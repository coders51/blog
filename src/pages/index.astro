---
import { getCollection } from "astro:content";
import FormattedDate from "../components/FormattedDate.astro";
import BaseLayout from "../layouts/BaseLayout.astro";
import Author from "src/components/Author.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "src/consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <main>
    <section class="flex flex-col gap-4">
      {
        posts.map(post => (
          <div class="prose-img:m-0 prose-h3:mb-1 prose-h3:mt-0 prose-p:mt-0 ">
            <a href={`/${post.slug}/`} class="no-underline text-black hover:!text-sky-600 dark:hover:!text-sky-500 group">
              <div class="flex flex-col rounded-lg shadow-lg dark:bg-darkBg/80 bg-lightBg/30">
                <img
                  class="w-full h-32 xl:h-36 rounded-t-lg object-cover"
                  src={`/posts/${post.data.heroImage}`}
                  alt={post.data.title}
                />
                <div class="px-4 pb-4 pt-2">
                    <h3 class="line-clamp-2 transition duration-300 group-hover:!text-sky-600 dark:hover:!text-sky-500">
                      {post.data.title}
                    </h3>
                  <p class="sm:line-clamp-3 line-clamp-2 leading-tight">
                    {post.data.description}
                  </p>
                  <div class="flex items-center space-x-2 text-sm">
                    <FormattedDate date={post.data.pubDate} />
                    <span>â€¢</span>
                    <Author author={post.data.author} />
                  </div>
                </div>
              </div>
            </a>
          </div>
        ))
      }
    </section>
  </main>
</BaseLayout>
